<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Beating the Bookies</title>
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="/css/styles.css" rel="stylesheet" />
    </head>
    <body>
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
            <div class="container">
                <a class="navbar-brand" href="../index.html">Home</a>
                <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    Menu
                    <i class="fas fa-bars"></i>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
                        <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
                        <li class="nav-item"><a class="nav-link" href="../images/CV.pdf">CV</a></li>
                        <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Page Header-->
        <header class="masthead" style="background-image: url('/images/Rplot.png')">
            <div class="overlay"></div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-md-10 mx-auto">
                        <div class="post-heading">
                            <h1>Beating the Bookies</h1>
                            <h2 class="subheading">Premier league match result prediction</h2>
                            <span class="meta">
                                Posted by
                                <a href="../html/about.html">Christian Payne</a>
                                on 30th June, 2021
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!-- Post Content-->
        <article>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-md-10 mx-auto">
                        <p>With the 2020-21 Premier League season over, I have been working on a way to apply my predictive AI skills to the problem of football match prediction. Over the past couple of months I have been collecting data on historic performance, transfer data, player stats, and more to construct a dataset on premier league matches.</p>
                        <h2 class="section-heading">Baselines</h2>
                        <p>In order to do so, we first have to develop a baseline of match prediction to compare with our model. A baseline is simply a metric so we can assess the contribution of the model to our prediction accuracy. Guessing randomly is a common baseline to be compared against so we will examine the accuracy of two baseline strategies. Namely guessing randomly between away wins, home wins and draws (strategy 1) and randomly guessing between away or home wins (strategy 2).</p>
                        <img src="/images/strat_compare.png" width="650" height="400">
                        <p>The above graph compares the prediction accuracy of two baseline strategies over the course of the 20-21 Premier League season. The faint blue lines represent the prediction accuracy of each of 10 simulated seasons where either away or home wins were predicted. While the faint red line showcase the simulated outcomes for the strategy of picking between a home win, an away win, or a draw. The darker lines show the average accuracy for their respective strategies over the course of the season. Using these simulations, we can also estimate the probabilities of achieving any giving win percentage at the end of the season.</p>
                        <table>
                            <tr>
                                <th>Accuracy</th>
                                <th>Strategy 1 odds</th>
                                <th>Strategy 2 odds</th>
                            </tr>
                            <tr>
                                <td>≤30%</td>
                                <td>1 in 0.008</td>
                                <td>1 in 0.0000...</td>
                            </tr>
                            <tr>
                                <td>≤40%</td>
                                <td>1 in 273</td>
                                <td>1 in 0.04</td>
                            </tr>
                            <tr>
                                <td>≤50%</td>
                                <td>1 in 999999...</td>
                                <td>1 in 61</td>
                            </tr>
                            <tr>
                                <td>≤60%</td>
                                <td>1 in 999999...</td>
                                <td>1 in 999999...</td>
                            </tr>
                        </table>
                        <p>The odds then get progressively more unachievable from there. So now we know how good randomly guessing would be, exactly how good are the bookies?</p>
                        <h2 class="section-heading">The Opposition</h2>
                        <p>So, how good are the bookies at predicting the results of Premier League matches? The graph below shows the accuracy of a number of popular odds makers over the course of the 20-21 Premier League season.</p>
                        <img src="/images/bet_compare.png" width="650" height="400">
                        <p>On average, the bookies accurately predicted around 51.57% of games during the season. VC Bet and Bet&Win tied for most accurate correctly predicting 51.84% of all games. Meanwhile, Interwetten and Pinnacle are tied for least accurate with a seasonal accuracy of 51.32%. There is only one correctly predicted game between the two most accurate bookies and the average, and another game between the average and the two least accurate. What's also interesting is that there are significant differences in the prediction accuracy for each team with the bookies faring better in predicting the outcomes of matches involving some teams over others.</p>
                        <img src="/images/bet_team.png" width="650" height="400">
                        <p>Interestingly, Sheffield United games were the easiest to predict with an average accuracy of 81.57%. Meanwhile Brighton games were the hardest to predict, with an average accuracy of only 31.57%. But enough about the bookies, let's get onto our team.</p>
                        <h2 class="section-heading">The Model</h2>
                        <p>Our model is a neural network trained on our dataset, including data from <a href = "https://fbref.com/en/">FBref</a>, <a href= "https://www.football-data.co.uk/">football-data</a>, and Github user <a href= "https://raw.githubusercontent.com/ewenme/transfers/master/data">ewenme</a>. So how well does it perform? Pretty well. Below is a comparison of the accuracy of the model compared with the average bookie over the course of the 20-21 season.</p>
                        <img src="/images/model_compare.png" width="650" height="400">
                        <p>At first glance, this performance may seem somewhat undewhelming, but the model outperforms the average bookies. The model even outperforms the two most accurate bookies, VC Bet and Bet&Win. Specifically, the model correctly guessed the outcome of 52.11% of games to their 51.84%.</p>
                    </div>
                </div>
            </div>
        </article>
        <hr />
        <!-- Footer-->
        <footer>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-md-10 mx-auto">
                        <ul class="list-inline text-center">
                            <li class="list-inline-item">
                                <a href="https://twitter.com/cpayneathome">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li class="list-inline-item">
                                <a href="https://github.com/ChrisPayneHome">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                        </ul>
                        <p class="copyright text-muted">Copyright &copy; Christian Payne's Website 2021</p>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Bootstrap core JS-->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
    </body>
</html>